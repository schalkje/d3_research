:root, [data-theme="neumorphism"] {
  --fd-bg: #e6e9ef;
  --fd-surface: #eef1f7;
  --fd-text: #2d3142;
  --fd-muted: #6b7280;
  --fd-accent: #6b9cff;
  --fd-border: #d1d5db;
  --fd-edge: #8892a6;
}

body { background: var(--fd-bg); color: var(--fd-text); font-family: 'Segoe UI', Roboto, Arial, sans-serif; }

/* soft elevated canvases */
#graph { background-color: var(--fd-surface); border: none; box-shadow: 10px 10px 20px #c8ccd4, -10px -10px 20px #ffffff; border-radius: 16px; }
.minimap-svg { background-color: rgba(255,255,255,0.6); border: none; box-shadow: inset 6px 6px 12px #d0d4dc, inset -6px -6px 12px #ffffff; border-radius: 12px; }
svg.canvas { border: none; box-shadow: 12px 12px 24px #c8ccd4, -12px -12px 24px #ffffff; border-radius: 16px; }

.shape, .rect.shape, .adapter.shape, .SSIS.shape, .container-shape, .circle.shape { fill: var(--fd-surface); stroke: #dfe3ea; stroke-width: 1.5px; filter: drop-shadow(6px 6px 12px rgba(0,0,0,.10)) drop-shadow(-6px -6px 12px rgba(255,255,255,.9)); rx: 12; ry: 12; transition: transform 160ms ease-out, filter 160ms ease-out, stroke-width 160ms ease-out; }
.shape:hover, .rect.shape:hover, .container-shape:hover { filter: drop-shadow(10px 10px 20px rgba(0,0,0,.14)) drop-shadow(-10px -10px 20px rgba(255,255,255,.95)); }
.container-shape.selected, .rect.shape.selected { filter: drop-shadow(12px 12px 24px rgba(0,0,0,.18)) drop-shadow(-12px -12px 24px rgba(255,255,255,.98)); }
/* Base header styling */
.header-background { fill: var(--fd-surface); stroke: none; }
.header-text { fill: var(--fd-text); font-weight: 600; text-anchor: start; dominant-baseline: middle; }

/* Collapsed container headers — neumorphic styling with status-based fills */
.collapsed .zone-header .header-background {
  stroke-width: 1px !important;
  filter: drop-shadow(3px 3px 6px rgba(0,0,0,.08)) drop-shadow(-3px -3px 6px rgba(255,255,255,.8)) !important;
}

.collapsed[status="Unknown"] .zone-header .header-background {
  fill: #eef2f7 !important;
  stroke: #d5dbe5 !important;
}

.collapsed[status="Ready"] .zone-header .header-background {
  fill: #e3f0ff !important;
  stroke: #bad7ff !important;
  filter: drop-shadow(3px 3px 6px rgba(107,215,255,0.15)) drop-shadow(-3px -3px 6px rgba(255,255,255,.9)) !important;
}

.collapsed[status="Updating"] .zone-header .header-background {
  fill: #ffe4b8 !important;
  stroke: #ffbf4d !important;
  filter: drop-shadow(3px 3px 6px rgba(255,191,77,0.15)) drop-shadow(-3px -3px 6px rgba(255,255,255,.9)) !important;
}

.collapsed[status="Updated"] .zone-header .header-background {
  fill: #ddf8eb !important;
  stroke: #9fe9c9 !important;
  filter: drop-shadow(3px 3px 6px rgba(159,233,201,0.15)) drop-shadow(-3px -3px 6px rgba(255,255,255,.9)) !important;
}

.collapsed[status="Skipped"] .zone-header .header-background {
  fill: #f6f2de !important;
  stroke: #eadb9c !important;
}

.collapsed[status="Delayed"] .zone-header .header-background {
  fill: #ffe7c2 !important;
  stroke: #ffcc87 !important;
  filter: drop-shadow(3px 3px 6px rgba(255,204,135,0.15)) drop-shadow(-3px -3px 6px rgba(255,255,255,.9)) !important;
}

.collapsed[status="Warning"] .zone-header .header-background {
  fill: #ffeab0 !important;
  stroke: #ffd06b !important;
  filter: drop-shadow(3px 3px 6px rgba(255,208,107,0.15)) drop-shadow(-3px -3px 6px rgba(255,255,255,.9)) !important;
}

.collapsed[status="Error"] .zone-header .header-background {
  fill: #ffd4d9 !important;
  stroke: #ff5a6b !important;
  filter: drop-shadow(3px 3px 6px rgba(255,90,107,0.15)) drop-shadow(-3px -3px 6px rgba(255,255,255,.9)) !important;
}

.collapsed[status="Disabled"] .zone-header .header-background {
  fill: #f1f3f5 !important;
  stroke: #d4d8dd !important;
}

/* Enhanced neumorphic header text styling */
.collapsed .zone-header .header-text {
  font-weight: 700 !important;
  text-shadow: 1px 1px 2px rgba(0,0,0,0.1), -1px -1px 2px rgba(255,255,255,0.8) !important;
}

/* Status-specific header text colors for collapsed containers */
.collapsed[status="Unknown"] .zone-header .header-text {
  fill: #475569 !important;
}

.collapsed[status="Ready"] .zone-header .header-text {
  fill: #1e40af !important;
}

.collapsed[status="Updating"] .zone-header .header-text {
  fill: #d97706 !important;
}

.collapsed[status="Updated"] .zone-header .header-text {
  fill: #059669 !important;
}

.collapsed[status="Skipped"] .zone-header .header-text {
  fill: #a16207 !important;
}

.collapsed[status="Delayed"] .zone-header .header-text {
  fill: #ea580c !important;
}

.collapsed[status="Warning"] .zone-header .header-text {
  fill: #d97706 !important;
}

.collapsed[status="Error"] .zone-header .header-text {
  fill: #dc2626 !important;
}

.collapsed[status="Disabled"] .zone-header .header-text {
  fill: #6b7280 !important;
}

text, .label, .rect.label { fill: var(--fd-text); }
.edge .path { stroke: var(--fd-edge); stroke-width: 2.25px; }

.zoom-button:hover circle { fill: #f6f8fc; stroke: #d7dce5; }
.zoom-icon { fill: var(--fd-text); }

/* Minimap overlays: eye soft, iris subtle raised outline */
.minimap-svg .eye { fill: var(--fd-bg) !important; fill-opacity: 0.6; filter: blur(8px); -webkit-filter: blur(8px); }
.minimap-svg .iris {
  fill: none !important;
  stroke: #b8c0cc !important;
  stroke-width: 6px !important;
  filter: drop-shadow(3px 3px 6px rgba(0,0,0,.10)) drop-shadow(-3px -3px 6px rgba(255,255,255,.7));
}


/* status colors: clearer separation with soft, neomorphic tints */
.shape[status="Unknown"], .node.shape[status="Unknown"], .container-shape[status="Unknown"], .rect.shape[status="Unknown"] {
  fill: #eef2f7; /* cool gray */
  stroke: #d5dbe5;
  stroke-width: 1.5px !important;
}
.shape[status="Ready"], .node.shape[status="Ready"], .container-shape[status="Ready"], .rect.shape[status="Ready"] {
  fill: #e3f0ff; /* gentle blue */
  stroke: #bad7ff;
  stroke-width: 2px !important;
}
.shape[status="Updating"], .node.shape[status="Updating"], .container-shape[status="Updating"], .rect.shape[status="Updating"] {
  fill: #ffe4b8;
  stroke: #ffbf4d;
  stroke-width: 2.5px !important;
  stroke-dasharray: 10 6;
}
.shape[status="Updated"], .node.shape[status="Updated"], .container-shape[status="Updated"], .rect.shape[status="Updated"] {
  fill: #ddf8eb; /* soothing green */
  stroke: #9fe9c9;
  stroke-width: 2px !important;
}
.shape[status="Skipped"], .node.shape[status="Skipped"], .container-shape[status="Skipped"], .rect.shape[status="Skipped"] {
  fill: #f6f2de; /* pale sand */
  stroke: #eadb9c;
  stroke-width: 2px !important;
}
.shape[status="Delayed"], .node.shape[status="Delayed"], .container-shape[status="Delayed"], .rect.shape[status="Delayed"] {
  fill: #ffe7c2; /* deeper amber */
  stroke: #ffcc87;
  stroke-width: 2px !important;
}
.shape[status="Warning"], .node.shape[status="Warning"], .container-shape[status="Warning"], .rect.shape[status="Warning"] {
  fill: #ffeab0; /* brighter warning */
  stroke: #ffd06b;
  stroke-width: 2.25px !important;
}
.shape[status="Error"], .node.shape[status="Error"], .container-shape[status="Error"], .rect.shape[status="Error"] {
  fill: #ffd4d9; /* stronger red tint */
  stroke: #ff5a6b; /* more assertive stroke */
  stroke-width: 2.75px !important;
}
.shape[status="Disabled"], .node.shape[status="Disabled"], .container-shape[status="Disabled"], .rect.shape[status="Disabled"] {
  fill: #f1f3f5; /* soft gray */
  stroke: #d4d8dd;
  stroke-width: 1.5px !important;
}

/* Updating: warm tint with soft pulse and slight lift — keeps neomorphic feel */
@keyframes neumo-update-pulse {
  0%, 100% {
    fill: #ffe4b8; /* base warm */
    stroke-width: 2.25px;
    filter: drop-shadow(6px 6px 12px rgba(0,0,0,.10)) drop-shadow(-6px -6px 12px rgba(255,255,255,.9));
    transform: scale(1);
  }
  50% {
    fill: #ffdca0; /* slightly richer */
    stroke-width: 3px;
    filter: drop-shadow(9px 9px 18px rgba(0,0,0,.14)) drop-shadow(-9px -9px 18px rgba(255,255,255,.95));
    transform: scale(1.012);
  }
}
/* Expanded containers — toned down (parent carries status) */
/* Expanded subdued state — adapters, marts, foundations only */
.adapter.expanded[status="Unknown"] > .zone-container > .container-shape,
.Adapter.expanded[status="Unknown"] > .zone-container > .container-shape,
.mart.expanded[status="Unknown"] > .zone-container > .container-shape,
.Mart.expanded[status="Unknown"] > .zone-container > .container-shape,
.foundation.expanded[status="Unknown"] > .zone-container > .container-shape,
.Foundation.expanded[status="Unknown"] > .zone-container > .container-shape {
  fill: #eef2f7 !important;
  fill-opacity: 0.2 !important;
  stroke: #d5dbe5 !important;
  stroke-width: 1px !important;
}

.adapter.expanded[status="Ready"] > .zone-container > .container-shape,
.Adapter.expanded[status="Ready"] > .zone-container > .container-shape,
.mart.expanded[status="Ready"] > .zone-container > .container-shape,
.Mart.expanded[status="Ready"] > .zone-container > .container-shape,
.foundation.expanded[status="Ready"] > .zone-container > .container-shape,
.Foundation.expanded[status="Ready"] > .zone-container > .container-shape {
  fill: #e3f0ff !important;
  fill-opacity: 0.25 !important;
  stroke: #d5dbe5 !important;
  stroke-width: 1px !important;
}

.adapter.expanded[status="Updating"] > .zone-container > .container-shape,
.Adapter.expanded[status="Updating"] > .zone-container > .container-shape,
.mart.expanded[status="Updating"] > .zone-container > .container-shape,
.Mart.expanded[status="Updating"] > .zone-container > .container-shape,
.foundation.expanded[status="Updating"] > .zone-container > .container-shape,
.Foundation.expanded[status="Updating"] > .zone-container > .container-shape {
  fill: #ffe4b8 !important;
  fill-opacity: 0.25 !important;
  stroke: #d5dbe5 !important;
  stroke-width: 1px !important;
  transform-box: fill-box;
  transform-origin: center;
  animation: none !important;
  stroke-dasharray: none !important;
}

.adapter.expanded[status="Updated"] > .zone-container > .container-shape,
.Adapter.expanded[status="Updated"] > .zone-container > .container-shape,
.mart.expanded[status="Updated"] > .zone-container > .container-shape,
.Mart.expanded[status="Updated"] > .zone-container > .container-shape,
.foundation.expanded[status="Updated"] > .zone-container > .container-shape,
.Foundation.expanded[status="Updated"] > .zone-container > .container-shape {
  fill: #ddf8eb !important;
  fill-opacity: 0.18 !important;
  stroke: #d5dbe5 !important;
  stroke-width: 1px !important;
}

.adapter.expanded[status="Skipped"] > .zone-container > .container-shape,
.Adapter.expanded[status="Skipped"] > .zone-container > .container-shape,
.mart.expanded[status="Skipped"] > .zone-container > .container-shape,
.Mart.expanded[status="Skipped"] > .zone-container > .container-shape,
.foundation.expanded[status="Skipped"] > .zone-container > .container-shape,
.Foundation.expanded[status="Skipped"] > .zone-container > .container-shape {
  fill: #f6f2de !important;
  fill-opacity: 0.9 !important;
  stroke: #d5dbe5 !important;
  stroke-width: 1px !important;
}

.adapter.expanded[status="Delayed"] > .zone-container > .container-shape,
.Adapter.expanded[status="Delayed"] > .zone-container > .container-shape,
.mart.expanded[status="Delayed"] > .zone-container > .container-shape,
.Mart.expanded[status="Delayed"] > .zone-container > .container-shape,
.foundation.expanded[status="Delayed"] > .zone-container > .container-shape,
.Foundation.expanded[status="Delayed"] > .zone-container > .container-shape {
  fill: #ffe7c2 !important;
  fill-opacity: 0.28 !important;
  stroke: #d5dbe5 !important;
  stroke-width: 1px !important;
}

.adapter.expanded[status="Warning"] > .zone-container > .container-shape,
.Adapter.expanded[status="Warning"] > .zone-container > .container-shape,
.mart.expanded[status="Warning"] > .zone-container > .container-shape,
.Mart.expanded[status="Warning"] > .zone-container > .container-shape,
.foundation.expanded[status="Warning"] > .zone-container > .container-shape,
.Foundation.expanded[status="Warning"] > .zone-container > .container-shape {
  fill: #ffeab0 !important;
  fill-opacity: 0.28 !important;
  stroke: #d5dbe5 !important;
  stroke-width: 1px !important;
}

.adapter.expanded[status="Error"] > .zone-container > .container-shape,
.Adapter.expanded[status="Error"] > .zone-container > .container-shape,
.mart.expanded[status="Error"] > .zone-container > .container-shape,
.Mart.expanded[status="Error"] > .zone-container > .container-shape,
.foundation.expanded[status="Error"] > .zone-container > .container-shape,
.Foundation.expanded[status="Error"] > .zone-container > .container-shape {
  fill: #ffd4d9 !important;
  fill-opacity: 0.28 !important;
  stroke: #d5dbe5 !important;
  stroke-width: 1px !important;
}

.adapter.expanded[status="Disabled"] > .zone-container > .container-shape,
.Adapter.expanded[status="Disabled"] > .zone-container > .container-shape,
.mart.expanded[status="Disabled"] > .zone-container > .container-shape,
.Mart.expanded[status="Disabled"] > .zone-container > .container-shape,
.foundation.expanded[status="Disabled"] > .zone-container > .container-shape,
.Foundation.expanded[status="Disabled"] > .zone-container > .container-shape {
  fill: #f1f3f5 !important;
  fill-opacity: 0.2 !important;
  stroke: #d5dbe5 !important;
  stroke-width: 1px !important;
}

/* Keep base node animations; only containers are disabled above */
.shape[status="Updating"], .node.shape[status="Updating"], .rect.shape[status="Updating"] {
  fill: #ffe4b8;
  stroke: #ffbf4d;
  stroke-width: 2.25px;
  transform-box: fill-box;
  transform-origin: center;
  animation: neumo-update-pulse 1.2s ease-in-out infinite;
}

/* Container node state theming
   - Expanded (default): toned down vs base nodes, no animations
   - Collapsed: clear, full-opacity states, no animations
   Note: container status is on the parent <g>, not the rect */

/* Collapsed containers — styled like rect nodes (parent carries status) */
.collapsed .container-shape { opacity: 1 !important; filter: drop-shadow(6px 6px 12px rgba(0,0,0,.10)) drop-shadow(-6px -6px 12px rgba(255,255,255,.9)); }
.collapsed[status="Unknown"] .container-shape {
  fill: #eef2f7 !important;
  stroke: #d5dbe5 !important;
  stroke-width: 1.5px !important;
}
.collapsed[status="Ready"] .container-shape {
  fill: #e3f0ff !important;
  stroke: #bad7ff !important;
  stroke-width: 2px !important;
}
.collapsed[status="Updating"] .container-shape {
  fill: #ffe4b8 !important;
  stroke: #ffbf4d !important;
  stroke-width: 2.5px !important;
  /* Removed dotted lines - now solid like requested */
}
.collapsed[status="Updated"] .container-shape {
  fill: #ddf8eb !important;
  stroke: #9fe9c9 !important;
  stroke-width: 2px !important;
}
.collapsed[status="Skipped"] .container-shape {
  fill: #f6f2de !important;
  stroke: #eadb9c !important;
  stroke-width: 2px !important;
}
.collapsed[status="Delayed"] .container-shape {
  fill: #ffe7c2 !important;
  stroke: #ffcc87 !important;
  stroke-width: 2px !important;
}
.collapsed[status="Warning"] .container-shape {
  fill: #ffeab0 !important;
  stroke: #ffd06b !important;
  stroke-width: 2.25px !important;
}
.collapsed[status="Error"] .container-shape {
  fill: #ffd4d9 !important;
  stroke: #ff5a6b !important;
  stroke-width: 2.75px !important;
}
.collapsed[status="Disabled"] .container-shape {
  fill: #f1f3f5 !important;
  stroke: #d4d8dd !important;
  stroke-width: 1.5px !important;
}

/* Expanded lanes/columns: ignore state (no fill/animation), keep soft stroke */
.lane.expanded > .zone-container > .container-shape,
.Lane.expanded > .zone-container > .container-shape,
.columns.expanded > .zone-container > .container-shape,
.Columns.expanded > .zone-container > .container-shape {
  fill: none !important;
  fill-opacity: 0 !important;
  animation: none !important;
  stroke-dasharray: none !important;
  stroke: #dfe3ea !important;
}

/*
  Nested container depth styling for Neumorphism theme
  Subtle shadow and highlight gradation for visual hierarchy
*/
[data-theme="neumorphism"] :is(.lane, .columns, .group, .adapter, .mart, .foundation) :is(.lane, .columns, .group, .adapter, .mart, .foundation) > .zone-container > .container-shape {
  fill-opacity: 0.95 !important;
  filter: drop-shadow(4px 4px 8px rgba(0,0,0,.08)) drop-shadow(-4px -4px 8px rgba(255,255,255,.85)) !important;
}
[data-theme="neumorphism"] :is(.lane, .columns, .group, .adapter, .mart, .foundation) :is(.lane, .columns, .group, .adapter, .mart, .foundation) > .zone-header > .header-background {
  fill-opacity: 0.95 !important;
  filter: drop-shadow(2px 2px 4px rgba(0,0,0,.06)) drop-shadow(-2px -2px 4px rgba(255,255,255,.8)) !important;
}

[data-theme="neumorphism"] :is(.lane, .columns, .group, .adapter, .mart, .foundation) :is(.lane, .columns, .group, .adapter, .mart, .foundation) :is(.lane, .columns, .group, .adapter, .mart, .foundation) > .zone-container > .container-shape {
  fill-opacity: 0.9 !important;
  filter: drop-shadow(6px 6px 12px rgba(0,0,0,.12)) drop-shadow(-6px -6px 12px rgba(255,255,255,.8)) !important;
}
[data-theme="neumorphism"] :is(.lane, .columns, .group, .adapter, .mart, .foundation) :is(.lane, .columns, .group, .adapter, .mart, .foundation) :is(.lane, .columns, .group, .adapter, .mart, .foundation) > .zone-header > .header-background {
  fill-opacity: 0.9 !important;
  filter: drop-shadow(3px 3px 6px rgba(0,0,0,.08)) drop-shadow(-3px -3px 6px rgba(255,255,255,.75)) !important;
}

[data-theme="neumorphism"] :is(.lane, .columns, .group, .adapter, .mart, .foundation) :is(.lane, .columns, .group, .adapter, .mart, .foundation) :is(.lane, .columns, .group, .adapter, .mart, .foundation) :is(.lane, .columns, .group, .adapter, .mart, .foundation) > .zone-container > .container-shape {
  fill-opacity: 0.85 !important;
  filter: drop-shadow(8px 8px 16px rgba(0,0,0,.16)) drop-shadow(-8px -8px 16px rgba(255,255,255,.75)) !important;
}
[data-theme="neumorphism"] :is(.lane, .columns, .group, .adapter, .mart, .foundation) :is(.lane, .columns, .group, .adapter, .mart, .foundation) :is(.lane, .columns, .group, .adapter, .mart, .foundation) :is(.lane, .columns, .group, .adapter, .mart, .foundation) > .zone-header > .header-background {
  fill-opacity: 0.85 !important;
  filter: drop-shadow(4px 4px 8px rgba(0,0,0,.1)) drop-shadow(-4px -4px 8px rgba(255,255,255,.7)) !important;
}

[data-theme="neumorphism"] :is(.lane, .columns, .group, .adapter, .mart, .foundation) :is(.lane, .columns, .group, .adapter, .mart, .foundation) :is(.lane, .columns, .group, .adapter, .mart, .foundation) :is(.lane, .columns, .group, .adapter, .mart, .foundation) :is(.lane, .columns, .group, .adapter, .mart, .foundation) > .zone-container > .container-shape {
  fill-opacity: 0.8 !important;
  filter: drop-shadow(10px 10px 20px rgba(0,0,0,.2)) drop-shadow(-10px -10px 20px rgba(255,255,255,.7)) !important;
}
[data-theme="neumorphism"] :is(.lane, .columns, .group, .adapter, .mart, .foundation) :is(.lane, .columns, .group, .adapter, .mart, .foundation) :is(.lane, .columns, .group, .adapter, .mart, .foundation) :is(.lane, .columns, .group, .adapter, .mart, .foundation) :is(.lane, .columns, .group, .adapter, .mart, .foundation) > .zone-header > .header-background {
  fill-opacity: 0.8 !important;
  filter: drop-shadow(5px 5px 10px rgba(0,0,0,.12)) drop-shadow(-5px -5px 10px rgba(255,255,255,.65)) !important;
}


