<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>states – themes grid (foundation explicit)</title>

    <style>
      :root { --card-w: 250px; --card-h: 400px; }
      body {
        margin: 0;
        font-family: system-ui, Segoe UI, Arial, sans-serif;
        background: #f5f6f8;
        color: #222;
      }
      header { padding: 16px; }
      h1 { font-size: 20px; margin: 0 0 8px; }
      p { margin: 0; color: #555; }

      .grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(var(--card-w), 1fr));
        gap: 12px;
        padding: 12px 16px 24px;
      }

      .card {
        width: var(--card-w);
        height: var(--card-h);
        border: 1px solid #ddd;
        border-radius: 8px;
        background: #fff;
        box-shadow: 0 2px 6px rgba(0,0,0,0.05);
        display: flex;
        flex-direction: column;
        overflow: hidden;
        margin: 0 auto;
      }

      .card h3 {
        margin: 0;
        padding: 8px 10px;
        font-size: 13px;
        font-weight: 600;
        background: #fafafa;
        border-bottom: 1px solid #eee;
        text-transform: capitalize;
      }

      .card iframe {
        border: 0;
        width: 100%;
        height: 100%;
        flex: 1 1 auto;
      }
    </style>
  </head>
  <body>
    <header>
      <h1>states – themes grid (foundation explicit)</h1>
      <p>Single foundation node with explicit role children.</p>
    </header>

    <section id="grid" class="grid" aria-label="Themes Grid"></section>

    <script>
      const themes = [
        'light',
        'dark',
        'brutalism',
        'cyberpunk',
        'flat',
        'glassmorphism',
        'neumorphism',
        'retro'
      ];

      const grid = document.getElementById('grid');

      themes.forEach(theme => {
        const card = document.createElement('div');
        card.className = 'card';

        const title = document.createElement('h3');
        title.textContent = theme;
        card.appendChild(title);

        const iframe = document.createElement('iframe');
        iframe.setAttribute('title', `Dashboard theme: ${theme}`);
        iframe.srcdoc = `<!DOCTYPE html>
<html>
  <head>
    <meta charset=\"utf-8\" />
    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />
    <style>
      html, body { height: 100%; margin: 0; }
      body { display: flex; }
      .wrap { flex: 1 1 auto; display: flex; }
      svg#graph.canvas { width: 100%; height: 100%; border: 1px solid #ddd; }
    </style>
    <link rel=\"stylesheet\" href=\"../../dashboard/flowdash.css\" />
    <link rel=\"stylesheet\" href=\"../../dashboard/themes/${theme}/flowdash.css\" />
  </head>
  <body>
    <div class=\"wrap\">
      <svg id=\"graph\" class=\"canvas\"></svg>
    </div>
  </body>
</html>`;

        iframe.addEventListener('load', () => {
          const doc = iframe.contentDocument;
          const addScript = (src) => new Promise((resolve, reject) => {
            const s = doc.createElement('script');
            s.src = src;
            s.onload = resolve;
            s.onerror = () => reject(new Error('Failed to load ' + src));
            doc.head.appendChild(s);
          });

          addScript('../../dashboard/libs/d3.min.js')
            .then(() => addScript('../../dashboard/libs/d3-shape.min.js'))
            .then(() => addScript('../../dashboard/libs/d3-dag.iife.min.js'))
            .then(() => {
              const mod = doc.createElement('script');
              mod.type = 'module';
              mod.textContent = `
                import { demoData } from './js/graphData.foundation-explicit.js';
                import flowDashboard from '../../dashboard/js/index.js';
                const data = {
                  ...demoData,
                  settings: {
                    ...demoData.settings,
                    minimap: { enabled: false }
                  }
                };
                const flowdash = new flowDashboard.Dashboard(data);
                flowdash.initialize('#graph');
                window.flowdash = flowdash;
                requestAnimationFrame(() => {
                  const btn = document.querySelector('.fullscreen-toggle');
                  if (btn && !flowdash.main.svg.classed('flowdash-fullscreen')) {
                    try { btn.click(); } catch {}
                  }
                  const overlay = document.querySelector('.fullscreen-overlay');
                  if (overlay) overlay.style.display = 'none';
                });
              `;
              doc.body.appendChild(mod);
            })
            .catch(err => console.error('Failed to load scripts for theme', `${theme}:`, err));
        });

        card.appendChild(iframe);
        grid.appendChild(card);
      });
    </script>
  </body>
</html>



